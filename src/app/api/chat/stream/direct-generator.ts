// 직접 생성 방식 헬퍼
export function generateToolDescription(tool: any, idx: number): string {
  const desc = tool.description || (tool as any).oneLiner || '';
  let cat = (tool.category?.toLowerCase() || 'ai').trim();
  const features = Array.isArray(tool.features) ? tool.features : [];
  
  // 카테고리별 사용 예시 풀 - 친근하고 구체적인 시나리오
  const usecasePool: Record<string, string[]> = {
    'ppt': [
      '월요일 아침 회의 자료를 주말에 미리 준비해두고 싶을 때',
      '투자자 미팅 D-1, 급하게 피칭덱 디자인을 개선해야 할 때',
      '논문 발표 준비하면서 복잡한 데이터를 깔끔하게 정리하고 싶을 때',
      '신제품 발표회에서 우리 브랜드만의 색깔을 살리고 싶을 때',
      '분기 보고서의 숫자들을 한눈에 들어오는 차트로 바꾸고 싶을 때',
      '온라인 강의 자료에 학생들이 좋아할 인터랙티브 요소를 넣고 싶을 때',
      '중요한 클라이언트 미팅 전날, 맞춤형 제안서를 완성해야 할 때',
      '팀원들과 함께 브레인스토밍하며 실시간으로 슬라이드를 만들 때'
    ],
    'presentation': [
      '첫 스타트업 피칭에서 투자자들의 마음을 사로잡고 싶을 때',
      '줌 웨비나에서 화면 공유해도 깨지지 않는 자료가 필요할 때',
      '아이디어 회의 결과를 한 장의 비주얼 맵으로 정리하고 싶을 때',
      '복잡한 프로젝트 일정을 누구나 이해하기 쉽게 보여주고 싶을 때',
      '신기능 데모를 단계별로 자연스럽게 설명하고 싶을 때',
      '연말 성과를 임팩트 있는 인포그래픽으로 어필하고 싶을 때',
      '각 고객사별로 다른 버전의 제안서를 효율적으로 만들 때',
      'TED 스타일의 발표를 준비하며 청중과 소통하고 싶을 때'
    ],
    'workflow': [
      '매일 반복되는 데이터 입력/전송을 자동화하고 싶을 때',
      '신규 리드가 들어오면 CRM 등록·슬랙 알림·메일 발송까지 한 번에',
      '폼 제출 → 구글시트 기록 → 결제/영수증 발행을 자동화',
      '웹훅/트리거 기반으로 여러 SaaS를 조건별로 분기 처리',
      '이미 운영 중인 내부 API와 외부 서비스(슬랙, 지메일) 연동',
      '디자인팀/영업팀 등 부서별 요청을 자동 라우팅해서 처리',
      '서비스 상태 체크와 장애 알림을 시간 기반으로 자동화',
      'ETL 파이프라인 구성해 데이터 적재·정제·전송 자동화'
    ],
    'uiux': [
      '디자인 시스템을 토대로 일관된 UI 컴포넌트를 생성',
      '와이어프레임을 인터랙티브 프로토타입으로 빠르게 전환',
      '사용자 여정 맵을 시각화해 UX 개선 포인트를 도출',
      'A/B 테스트용 변형 화면을 자동 생성해 실험 속도 향상',
      '접근성 체크리스트를 기반으로 UI 개선 항목 도출',
      '디자인 토큰을 코드로 내보내 개발 협업 속도 향상'
    ],
    'image': [
      '브랜드 로고를 다양한 스타일로 생성',
      '소셜미디어용 이미지 일괄 제작',
      '제품 목업 이미지를 빠르게 생성',
      '일러스트레이션을 프롬프트로 제작',
      '배경 이미지를 원하는 분위기로 생성'
    ],
    'video': [
      '유튜브 쇼츠를 스크립트만으로 제작',
      '제품 홍보 영상을 자동으로 편집',
      '교육 영상에 자막과 효과 추가',
      'SNS용 짧은 클립을 빠르게 생성',
      '프레젠테이션을 동영상으로 변환'
    ],
    'write': [
      '블로그 포스트를 SEO 최적화로 작성',
      '마케팅 카피를 타겟별로 생성',
      '이메일 템플릿을 상황별로 제작',
      '보고서를 구조화하여 자동 작성',
      '소설이나 시나리오 초안 생성'
    ],
    'novel': [
      '아이디어에서 로그라인을 뽑고 장르에 맞게 변주',
      '3막 구조에 따라 갈등-반전-해결을 서사로 배치',
      '캐릭터 시트로 성격·목표·약점·관계를 정리',
      '설정 성립 검증(세계관 룰·매직 시스템·물리 법칙)',
      '시점/서술자 일관성 점검과 톤 앤 매너 유지',
      '챕터 요약과 장면 전환 힌트로 집필 속도 향상'
    ],
    'chat': [
      '고객 문의에 24시간 자동 응답',
      '팀 커뮤니케이션을 AI로 효율화',
      '다국어 실시간 번역 대화',
      '전문 지식 Q&A 시스템 구축',
      '개인 비서처럼 일정 관리'
    ]
  };
  
  // 장점 풀 - 실질적인 이점을 친근하게 설명
  const advantagePool: Record<string, string[]> = {
    'ppt': [
      'AI가 알아서 디자인 밸런스를 맞춰주니 디자인 고민 끝',
      '우리 회사 브랜드 컬러와 폰트를 자동으로 적용해줘요',
      '전문 디자이너가 만든 템플릿이 수백 개나 준비되어 있어요',
      '팀원들이 동시에 편집해도 충돌 없이 자동 저장됩니다',
      '엑셀 데이터만 넣으면 예쁜 차트가 뚝딱 완성돼요',
      '스마트 레이아웃이 콘텐츠에 맞춰 자동으로 조정됩니다',
      '발표자 노트와 타이머 기능으로 프레젠테이션 연습도 가능해요'
    ],
    'presentation': [
      '드래그 앤 드롭만으로 전문가급 슬라이드가 완성됩니다',
      '애니메이션과 전환 효과를 AI가 자동으로 추천해줘요',
      '모바일에서도 PC에서도 깨지지 않는 반응형 디자인',
      '발표 중에도 실시간으로 수정할 수 있는 유연함',
      '청중 반응을 실시간으로 확인할 수 있는 분석 기능',
      '클라우드 저장으로 언제 어디서나 접근 가능해요',
      '버전 관리가 자동으로 되어 이전 버전 복구도 간단합니다'
    ],
    'workflow': [
      '노코드/로우코드로 빠르게 자동화 파이프라인 구성',
      '수백 개 커넥터와 웹훅/트리거로 복잡한 흐름도 손쉽게',
      '분기/지연/재시도 등 고급 제어로 운영 안정성 확보',
      '런타임 로그/리트라이로 장애 시 복구가 빠름',
      'API 연동·데이터 맵핑을 UI로 설정해 협업이 쉬움',
      '셀프호스팅/클라우드 등 배포 옵션이 유연함'
    ],
    'uiux': [
      '디자인 토큰/컴포넌트로 개발-디자인 간 간극 축소',
      '프로토타입-사용성 테스트 루프가 빨라져 검증 가속',
      '접근성 가이드를 자동 체크해 품질 리스크 감소',
      '디자인 시스템과 연계해 일관성 있는 화면 제작',
      '실사용 데이터 기반 UX 개선 포인트 추천'
    ],
    'image': [
      '스타일 일관성을 자동으로 유지',
      '고해상도 출력을 빠르게 생성',
      '다양한 아트 스타일 즉시 적용',
      '반복 생성으로 최적 결과 선택',
      '상업적 사용 가능한 라이선스'
    ],
    'video': [
      '편집 시간을 90% 단축',
      '자동 자막 생성 및 동기화',
      '다양한 전환 효과 자동 적용',
      '배경음악 자동 매칭',
      '소셜미디어별 최적 포맷 지원'
    ],
    'write': [
      'SEO 키워드 자동 최적화',
      '톤앤매너를 일관되게 유지',
      '다국어 번역 동시 지원',
      '표절 검사 기능 내장',
      '문법 및 맞춤법 자동 교정'
    ],
    'novel': [
      '장르 템플릿과 예시 플롯으로 초안 생성 속도 향상',
      '캐릭터 일관성 체크와 동기·갈등 자동 피드백',
      '세계관/용어사전 관리로 장편에서도 설정 충돌 감소',
      '대사 자연스러움·서술 리듬 개선을 위한 문체 보정',
      '챕터별 요약/미리보기 생성으로 줄거리 관리 용이'
    ],
    'chat': [
      '자연스러운 대화 흐름 유지',
      '컨텍스트 이해로 정확한 답변',
      '감정 분석으로 맞춤형 응답',
      '멀티턴 대화 완벽 지원',
      '학습 기능으로 지속적 개선'
    ]
  };
  
  // 팁 풀 - 바로 써먹을 수 있는 꿀팁들
  const tipPool = [
    '처음엔 템플릿 그대로 써보고, 익숙해지면 커스터마이징 해보세요',
    '브랜드 컬러 코드를 미리 저장해두면 일관성 있는 디자인이 가능해요',
    '팀 작업할 땐 댓글 기능으로 수정사항을 명확하게 전달하세요',
    'Ctrl+D로 슬라이드 복제하면 비슷한 레이아웃 작업이 훨씬 빨라져요',
    '무료 버전으로 충분히 연습한 후 유료 전환을 고려해보세요',
    '자주 쓰는 이미지나 로고는 라이브러리에 저장해두면 편해요',
    '발표 전날엔 꼭 PDF로도 백업해두세요. 만약을 대비해서요',
    '스마트폰 앱도 설치하면 이동 중에도 간단한 수정이 가능합니다',
    '유튜브에서 "(도구명) tutorial"로 검색하면 숨은 기능들을 발견할 수 있어요',
    '다른 사용자들의 템플릿을 참고하면 디자인 아이디어를 얻을 수 있어요',
    '매주 수요일에 업데이트가 많으니 새 기능을 확인해보세요',
    '작업 중간중간 자동 저장되지만, 중요한 작업은 수동 저장도 잊지 마세요'
  ];
  
  // 설명 생성 (도구별 특성 반영) - 더 길게, 완전한 문장으로
  let shortDesc = '';
  if (desc && desc.length > 20) {
    // 마침표나 쉼표 위치 찾기
    const endIdx = desc.indexOf('.');
    const commaIdx = desc.indexOf(',');
    const cutIdx = endIdx > 0 && endIdx < 80 ? endIdx : 
                   commaIdx > 0 && commaIdx < 80 ? commaIdx : 60;
    shortDesc = desc.slice(0, cutIdx).replace(/[.,]$/, '');
  }
  if (!shortDesc) {
    shortDesc = features.length > 0 ? 
      `${features[0]}를 지원하는 ${cat.toUpperCase()} 도구` :
      `${cat} 작업을 자동화하는 AI 도구`;
  }
  
  // 사용 예시 선택 (카테고리와 인덱스 기반)
  if (cat === 'ai' && /n8n|make|zapier|workflow|automation/i.test(tool.name + ' ' + (tool.category || '') + ' ' + features.join(' '))) {
    cat = 'workflow';
  }
  if (cat === 'design' || cat === 'ui/ux' || cat === 'uiux') {
    cat = 'uiux';
  }
  if (cat === 'novel' || /novel|소설|픽션|서사|스토리/i.test(features.join(' ') + ' ' + (tool.category || '') + ' ' + tool.name)) {
    cat = 'novel';
  }
  const usecases = usecasePool[cat] || usecasePool['workflow'] || usecasePool['image'] || ['프로젝트를 효율적으로 완성하기'];
  const usecase = usecases[(idx - 1) % usecases.length];
  
  // 장점 선택 (기술적 특징 중심)
  const advantages = advantagePool[cat] || advantagePool['workflow'] || advantagePool['image'] || ['AI 기술로 작업 시간 단축'];
  let advantage = advantages[(idx - 1) % advantages.length];
  
  // 특별 케이스 처리 (가격 대신 기술적 특징 강조)
  if (tool.hasAPI && idx % 3 === 0) {
    advantage = 'API 연동으로 자동화 워크플로우 구축 가능';
  } else if (features.includes('collaboration') || features.includes('team')) {
    advantage = '실시간 협업으로 팀 생산성 극대화';
  } else if (features.includes('template') || features.includes('templates')) {
    advantage = '전문가 디자인 템플릿으로 품질 보장';
  }
  
  // 팁 선택 (도구명 해시 기반으로 다양성 확보)
  const tipIdx = (tool.name.charCodeAt(0) + tool.name.charCodeAt(tool.name.length - 1) + idx) % tipPool.length;
  const tip = tipPool[tipIdx];
  
  // 최종 출력 생성 (친근하고 읽기 쉽게)
  return `${idx}. ${tool.name} — ${shortDesc}

   🎯 이런 상황에 딱이에요: ${usecase}
   ✨ 특별한 점: ${advantage}  
   💡 꿀팁: ${tip}

`;
}
